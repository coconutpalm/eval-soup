<!doctype html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="../../style.css">
        <link rel="stylesheet" type="text/css" href="../../paren-soup-light.css">
    </head>
    <body>
        <span id="app"><div data-reactroot="" data-reactid="1" data-react-checksum="-503705572"><div data-reactid="2"><div class="nses" data-reactid="3"><div data-reactid="4"><a href="../../clj/eval-soup.core.html" data-reactid="5">eval-soup.core</a></div><div data-reactid="6"><div class="tag" data-reactid="7">CLJS</div><a href="../../cljs/eval-soup.core.html" data-reactid="8">eval-soup.core</a></div></div></div><div style="left:300px;" class="vars" data-reactid="9"><!-- react-empty: 10 --><div class="var-info" data-reactid="11"><div data-reactid="12"><h2 data-reactid="13">(code-&gt;results forms cb)</h2><h2 data-reactid="14">(code-&gt;results forms cb {:keys [*current-ns *state custom-load timeout disable-timeout?], :or {*current-ns (atom (quote cljs.user)), *state *cljs-state, custom-load custom-load!, timeout 4000, disable-timeout? false}, :as opts})</h2></div><div class="section doc" data-reactid="15">Evaluates each form, providing the results in a callback.
  If any of the forms are strings, it will read them first.</div><div class="section" data-reactid="16"><h2 data-reactid="17">Example</h2><div class="section" data-reactid="18"><div class="section doc" data-reactid="19">You can reference vars you previously made.</div><div class="paren-soup" data-reactid="20"><div style="display:list-item;" class="instarepl" data-reactid="21"></div><div class="content" data-reactid="22"><span class='collection list'><span class='delimiter'>(</span><span class='symbol'>code-&gt;results</span> <span class='collection vector'><span class='delimiter'>[</span>&apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>def</span> <span class='symbol'>n</span> <span class='number'>4</span><span class='delimiter'>)</span></span> &apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>conj</span> <span class='collection vector'><span class='delimiter'>[</span><span class='number'>1</span> <span class='number'>2</span> <span class='number'>3</span><span class='delimiter'>]</span></span> <span class='symbol'>n</span><span class='delimiter'>)</span></span><span class='delimiter'>]</span></span> <span class='symbol'>callback</span><span class='delimiter'>)</span></span>
</div></div></div><div class="section" data-reactid="23"><div class="section doc" data-reactid="24">You can pass the code as strings too.</div><div class="paren-soup" data-reactid="25"><div style="display:list-item;" class="instarepl" data-reactid="26"></div><div class="content" data-reactid="27"><span class='collection list'><span class='delimiter'>(</span><span class='symbol'>code-&gt;results</span> <span class='collection vector'><span class='delimiter'>[</span><span class='string'>&quot;(def n 4)&quot;</span> <span class='string'>&quot;(conj [1 2 3] n)&quot;</span><span class='delimiter'>]</span></span> <span class='symbol'>callback</span><span class='delimiter'>)</span></span>
</div></div></div><div class="section" data-reactid="28"><div class="section doc" data-reactid="29">If your code exceeds the timeout, you&#x27;ll see an exception.
   
   You can turn off timeout protection by passing `:disable-timeout? true`
   in the options map.</div><div class="paren-soup" data-reactid="30"><div style="display:list-item;" class="instarepl" data-reactid="31"></div><div class="content" data-reactid="32"><span class='collection list'><span class='delimiter'>(</span><span class='symbol'>code-&gt;results</span> <span class='collection vector'><span class='delimiter'>[</span>&apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>while</span> <span class='boolean'>true</span><span class='delimiter'>)</span></span><span class='delimiter'>]</span></span> <span class='symbol'>callback</span> <span class='collection map'><span class='delimiter'>{</span><span class='keyword'>:timeout</span> <span class='number'>1000</span><span class='delimiter'>}</span></span><span class='delimiter'>)</span></span>
</div></div></div></div><div class="section" data-reactid="33"><h2 data-reactid="34">Source</h2><div class="paren-soup" data-reactid="35"><div class="content" data-reactid="36"><span class='collection list'><span class='delimiter'>(</span><span class='symbol'>defn</span>
 <span class='symbol'>code-&gt;results</span>
 <span class='string'>&quot;Evaluates each form, providing the results in a callback.\n  If any of the forms are strings, it will read them first.&quot;</span>
 <span class='collection list'><span class='delimiter'>(</span><span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>forms</span> <span class='symbol'>cb</span><span class='delimiter'>]</span></span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>code-&gt;results</span> <span class='symbol'>forms</span> <span class='symbol'>cb</span> <span class='collection map'><span class='delimiter'>{</span><span class='delimiter'>}</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
 <span class='collection list'><span class='delimiter'>(</span><span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>forms</span>
   <span class='symbol'>cb</span>
   <span class='collection map'><span class='delimiter'>{</span><span class='keyword'>:keys</span> <span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>*current-ns</span> <span class='symbol'>*state</span> <span class='symbol'>custom-load</span> <span class='symbol'>timeout</span> <span class='symbol'>disable-timeout?</span><span class='delimiter'>]</span></span>,
    <span class='keyword'>:or</span>
    <span class='collection map'><span class='delimiter'>{</span><span class='symbol'>*current-ns</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>atom</span> &apos;<span class='symbol'>cljs.user</span><span class='delimiter'>)</span></span>,
     <span class='symbol'>*state</span> <span class='symbol'>*cljs-state</span>,
     <span class='symbol'>custom-load</span> <span class='symbol'>custom-load!</span>,
     <span class='symbol'>timeout</span> <span class='number'>4000</span>,
     <span class='symbol'>disable-timeout?</span> <span class='boolean'>false</span><span class='delimiter'>}</span></span>,
    <span class='keyword'>:as</span> <span class='symbol'>opts</span><span class='delimiter'>}</span></span><span class='delimiter'>]</span></span>
  <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>let</span>
   <span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>forms</span>
    <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>mapv</span>
     <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>fn*</span>
      <span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>p1__18099#</span><span class='delimiter'>]</span></span>
      <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>if</span>
       <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>string?</span> <span class='symbol'>p1__18099#</span><span class='delimiter'>)</span></span>
       <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>str-&gt;form</span> @<span class='symbol'>*current-ns</span> <span class='symbol'>p1__18099#</span><span class='delimiter'>)</span></span>
       <span class='symbol'>p1__18099#</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
     <span class='symbol'>forms</span><span class='delimiter'>)</span></span>
    <span class='symbol'>init-forms</span>
    <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>vec</span>
     <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>concat</span>
      <span class='collection vector'><span class='delimiter'>[</span>&apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>ns</span> <span class='symbol'>cljs.user</span><span class='delimiter'>)</span></span><span class='delimiter'>]</span></span>
      <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>when-not</span>
       <span class='symbol'>disable-timeout?</span>
       <span class='collection vector'><span class='delimiter'>[</span>&apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>def</span> <span class='symbol'>ps-last-time</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>atom</span> <span class='number'>0</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
        &apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>defn</span>
          <span class='symbol'>ps-reset-timeout!</span>
          <span class='collection vector'><span class='delimiter'>[</span><span class='delimiter'>]</span></span>
          <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>reset!</span> <span class='symbol'>ps-last-time</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>.getTime</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>js/Date.</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
        &apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>defn</span>
          <span class='symbol'>ps-check-for-timeout!</span>
          <span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>timeout</span><span class='delimiter'>]</span></span>
          <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>when</span>
           <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>&gt;</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>-</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>.getTime</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>js/Date.</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span> @<span class='symbol'>ps-last-time</span><span class='delimiter'>)</span></span> <span class='symbol'>timeout</span><span class='delimiter'>)</span></span>
           <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>throw</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>js/Error.</span> <span class='string'>&quot;Execution timed out.&quot;</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>]</span></span><span class='delimiter'>)</span></span>
      <span class='collection vector'><span class='delimiter'>[</span>&apos;<span class='collection list'><span class='delimiter'>(</span><span class='symbol'>set!</span> <span class='symbol'>*print-err-fn*</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>fn</span> <span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>_</span><span class='delimiter'>]</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>list</span> &apos;<span class='symbol'>ns</span> @<span class='symbol'>*current-ns</span><span class='delimiter'>)</span></span><span class='delimiter'>]</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
    <span class='symbol'>timeout-cb</span>
    <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>fn</span>
     <span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>results</span><span class='delimiter'>]</span></span>
     <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>eval-forms</span>
      <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>add-timeouts-if-necessary</span> <span class='symbol'>timeout</span> <span class='symbol'>forms</span> <span class='symbol'>results</span><span class='delimiter'>)</span></span>
      <span class='symbol'>cb</span>
      <span class='symbol'>*state</span>
      <span class='symbol'>*current-ns</span>
      <span class='symbol'>custom-load</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
    <span class='symbol'>init-cb</span>
    <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>fn</span>
     <span class='collection vector'><span class='delimiter'>[</span><span class='symbol'>results</span><span class='delimiter'>]</span></span>
     <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>eval-forms</span>
      <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>if</span> <span class='symbol'>disable-timeout?</span> <span class='symbol'>forms</span> <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>map</span> <span class='symbol'>wrap-macroexpand</span> <span class='symbol'>forms</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
      <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>if</span> <span class='symbol'>disable-timeout?</span> <span class='symbol'>cb</span> <span class='symbol'>timeout-cb</span><span class='delimiter'>)</span></span>
      <span class='symbol'>*state</span>
      <span class='symbol'>*current-ns</span>
      <span class='symbol'>custom-load</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>]</span></span>
   <span class='collection list'><span class='delimiter'>(</span><span class='symbol'>eval-forms</span> <span class='symbol'>init-forms</span> <span class='symbol'>init-cb</span> <span class='symbol'>*state</span> <span class='symbol'>*current-ns</span> <span class='symbol'>custom-load</span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span><span class='delimiter'>)</span></span>
</div></div></div></div><div class="footer" data-reactid="37"><!-- react-text: 38 -->Generated by <!-- /react-text --><a href="https://github.com/oakes/Dynadoc" target="_blank" data-reactid="39">Dynadoc</a></div></div></div></span>
        <script type="text/edn" id="initial-state">{:ns-meta nil, :var-sym code->results, :type :cljs, :nses ({:var-syms [wrap-security code->results wrap-timeout eval_soup.core.proxy$java.lang.SecurityManager$ff19274a with-security], :type :clj, :sym eval-soup.core} {:var-syms [code->results], :type :cljs, :sym eval-soup.core}), :cljs-nses-and-vars {eval-soup.core ({:sym code->results, :meta {:doc "Evaluates each form, providing the results in a callback.\n  If any of the forms are strings, it will read them first.", :arglists [[forms cb] [forms cb {:keys [*current-ns *state custom-load timeout disable-timeout?], :or {*current-ns (atom (quote cljs.user)), *state *cljs-state, custom-load custom-load!, timeout 4000, disable-timeout? false}, :as opts}]]}, :source "(defn\n code->results\n \"Evaluates each form, providing the results in a callback.\\n  If any of the forms are strings, it will read them first.\"\n ([forms cb] (code->results forms cb {}))\n ([forms\n   cb\n   {:keys [*current-ns *state custom-load timeout disable-timeout?],\n    :or\n    {*current-ns (atom 'cljs.user),\n     *state *cljs-state,\n     custom-load custom-load!,\n     timeout 4000,\n     disable-timeout? false},\n    :as opts}]\n  (let\n   [forms\n    (mapv\n     (fn*\n      [p1__18099#]\n      (if\n       (string? p1__18099#)\n       (str->form @*current-ns p1__18099#)\n       p1__18099#))\n     forms)\n    init-forms\n    (vec\n     (concat\n      ['(ns cljs.user)]\n      (when-not\n       disable-timeout?\n       ['(def ps-last-time (atom 0))\n        '(defn\n          ps-reset-timeout!\n          []\n          (reset! ps-last-time (.getTime (js/Date.))))\n        '(defn\n          ps-check-for-timeout!\n          [timeout]\n          (when\n           (> (- (.getTime (js/Date.)) @ps-last-time) timeout)\n           (throw (js/Error. \"Execution timed out.\"))))])\n      ['(set! *print-err-fn* (fn [_])) (list 'ns @*current-ns)]))\n    timeout-cb\n    (fn\n     [results]\n     (eval-forms\n      (add-timeouts-if-necessary timeout forms results)\n      cb\n      *state\n      *current-ns\n      custom-load))\n    init-cb\n    (fn\n     [results]\n     (eval-forms\n      (if disable-timeout? forms (map wrap-macroexpand forms))\n      (if disable-timeout? cb timeout-cb)\n      *state\n      *current-ns\n      custom-load))]\n   (eval-forms init-forms init-cb *state *current-ns custom-load))))\n", :examples [{:doc "You can reference vars you previously made.", :with-callback callback, :body (code->results [(quote (def n 4)) (quote (conj [1 2 3] n))] callback), :body-str "(code->results ['(def n 4) '(conj [1 2 3] n)] callback)\n", :id "eval-soup.core/code->results/0"} {:doc "You can pass the code as strings too.", :with-callback callback, :body (code->results ["(def n 4)" "(conj [1 2 3] n)"] callback), :body-str "(code->results [\"(def n 4)\" \"(conj [1 2 3] n)\"] callback)\n", :id "eval-soup.core/code->results/1"} {:doc "If your code exceeds the timeout, you'll see an exception.\n   \n   You can turn off timeout protection by passing `:disable-timeout? true`\n   in the options map.", :with-callback callback, :body (code->results [(quote (while true))] callback {:timeout 1000}), :body-str "(code->results ['(while true)] callback {:timeout 1000})\n", :id "eval-soup.core/code->results/2"}]})}, :rel-path "../../", :static? true, :check-for-updates? false, :ns-sym eval-soup.core, :vars [{:sym code->results, :meta {:doc "Evaluates each form, providing the results in a callback.\n  If any of the forms are strings, it will read them first.", :arglists [[forms cb] [forms cb {:keys [*current-ns *state custom-load timeout disable-timeout?], :or {*current-ns (atom (quote cljs.user)), *state *cljs-state, custom-load custom-load!, timeout 4000, disable-timeout? false}, :as opts}]]}, :source "(defn\n code->results\n \"Evaluates each form, providing the results in a callback.\\n  If any of the forms are strings, it will read them first.\"\n ([forms cb] (code->results forms cb {}))\n ([forms\n   cb\n   {:keys [*current-ns *state custom-load timeout disable-timeout?],\n    :or\n    {*current-ns (atom 'cljs.user),\n     *state *cljs-state,\n     custom-load custom-load!,\n     timeout 4000,\n     disable-timeout? false},\n    :as opts}]\n  (let\n   [forms\n    (mapv\n     (fn*\n      [p1__18099#]\n      (if\n       (string? p1__18099#)\n       (str->form @*current-ns p1__18099#)\n       p1__18099#))\n     forms)\n    init-forms\n    (vec\n     (concat\n      ['(ns cljs.user)]\n      (when-not\n       disable-timeout?\n       ['(def ps-last-time (atom 0))\n        '(defn\n          ps-reset-timeout!\n          []\n          (reset! ps-last-time (.getTime (js/Date.))))\n        '(defn\n          ps-check-for-timeout!\n          [timeout]\n          (when\n           (> (- (.getTime (js/Date.)) @ps-last-time) timeout)\n           (throw (js/Error. \"Execution timed out.\"))))])\n      ['(set! *print-err-fn* (fn [_])) (list 'ns @*current-ns)]))\n    timeout-cb\n    (fn\n     [results]\n     (eval-forms\n      (add-timeouts-if-necessary timeout forms results)\n      cb\n      *state\n      *current-ns\n      custom-load))\n    init-cb\n    (fn\n     [results]\n     (eval-forms\n      (if disable-timeout? forms (map wrap-macroexpand forms))\n      (if disable-timeout? cb timeout-cb)\n      *state\n      *current-ns\n      custom-load))]\n   (eval-forms init-forms init-cb *state *current-ns custom-load))))\n", :examples [{:doc "You can reference vars you previously made.", :with-callback callback, :body (code->results [(quote (def n 4)) (quote (conj [1 2 3] n))] callback), :body-str "(code->results ['(def n 4) '(conj [1 2 3] n)] callback)\n", :id "eval-soup.core/code->results/0"} {:doc "You can pass the code as strings too.", :with-callback callback, :body (code->results ["(def n 4)" "(conj [1 2 3] n)"] callback), :body-str "(code->results [\"(def n 4)\" \"(conj [1 2 3] n)\"] callback)\n", :id "eval-soup.core/code->results/1"} {:doc "If your code exceeds the timeout, you'll see an exception.\n   \n   You can turn off timeout protection by passing `:disable-timeout? true`\n   in the options map.", :with-callback callback, :body (code->results [(quote (while true))] callback {:timeout 1000}), :body-str "(code->results ['(while true)] callback {:timeout 1000})\n", :id "eval-soup.core/code->results/2"}]}]}</script>
        <script type="text/javascript" src="../../main.js"></script>
    </body>
</html>
